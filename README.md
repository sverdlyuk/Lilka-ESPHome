# Lilka-ESPHome

# üíª ESPHome LVGL –¥–ª—è Lilka

**ESPHome –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –¥–ª—è Lilka –Ω–∞ –±–∞–∑—ñ ESP32-S3 –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é –≥—Ä–∞—Ñ—ñ—á–Ω–æ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—É LVGL (LittlevGL).**

![IMG_2284](https://github.com/user-attachments/assets/330f7477-2f81-4e32-b60c-75d941f841c9)

---


## üöÄ –ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

–¶—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –∑–∞–±–µ–∑–ø–µ—á—É—î –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª:

* **–ì—Ä–∞—Ñ—ñ—á–Ω–∏–π –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å (LVGL):**
    * ‚úÖ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –¥–∏—Å–ø–ª–µ—è ST7789V (280x240, SPI).
    * ‚úÖ –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è [LVGL](https://esphome.io/components/lvgl/) –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É.
    * ‚úÖ [Flex Layout](https://esphome.io/cookbook/lvgl/#flex-layout-positioning) –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç—ñ–≤.
    * ‚úÖ –î–∏–Ω–∞–º—ñ—á–Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è **—Å—Ç–∞–Ω—É –±–æ–π–ª–µ—Ä–∞ (Home Assistant Switch)**.
    * ‚úÖ –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è **—Ä—ñ–≤–Ω—è –∑–∞—Ä—è–¥—É —Ç–∞ –Ω–∞–ø—Ä—É–≥–∏ –±–∞—Ç–∞—Ä–µ—ó** –∑ –∞–≤—Ç–æ–æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º.

# üöÄ –û—Å–Ω–æ–≤–Ω—ñ –ú–µ—Ä–µ–∂–µ–≤—ñ –§—É–Ω–∫—Ü—ñ—ó ESPHome

* **OTA (Over-The-Air):** –î–æ–∑–≤–æ–ª—è—î –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –ø—Ä–æ—à–∏–≤–∫—É –ø—Ä–∏—Å—Ç—Ä–æ—é –±–µ–∑–¥—Ä–æ—Ç–æ–≤–æ —á–µ—Ä–µ–∑ Wi-Fi –ø—ñ—Å–ª—è –ø–µ—Ä—à–æ–≥–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è.
* **Web Server:** –ù–∞–¥–∞—î –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–∑–∞–∑–≤–∏—á–∞–π –Ω–∞ –ø–æ—Ä—Ç—É 80) –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É —Å—Ç–∞—Ç—É—Å—É, –ø–µ—Ä–µ–≥–ª—è–¥—É –ª–æ–≥—ñ–≤ —Ç–∞ –±–∞–∑–æ–≤–æ–≥–æ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –ø—Ä–∏—Å—Ç—Ä–æ—î–º —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä.
* **Captive Portal:** –°—Ç–≤–æ—Ä—é—î –∞–≤–∞—Ä—ñ–π–Ω—É Wi-Fi —Ç–æ—á–∫—É –¥–æ—Å—Ç—É–ø—É –¥–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö –º–µ—Ä–µ–∂—ñ, —è–∫—â–æ –ø—Ä–∏—Å—Ç—Ä—ñ–π –Ω–µ –º–æ–∂–µ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è.
* **mDNS (Multicast DNS):** –î–æ–∑–≤–æ–ª—è—î –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏ –ø—Ä–∏—Å—Ç—Ä—ñ–π —É –ª–æ–∫–∞–ª—å–Ω—ñ–π –º–µ—Ä–µ–∂—ñ –∑–∞ –∑—Ä–æ–∑—É–º—ñ–ª–∏–º —ñ–º–µ–Ω–µ–º (`lilka.local`), –∞ –Ω–µ –ª–∏—à–µ –∑–∞ IP-–∞–¥—Ä–µ—Å–æ—é.
* **Native API:** –í—Å—Ç–∞–Ω–æ–≤–ª—é—î —à–≤–∏–¥–∫–∏–π, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ç–∞ –æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–π –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π –∑–≤'—è–∑–æ–∫ –¥–ª—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –∑ Home Assistant.
* **BLE Tracker:** –ê–∫—Ç–∏–≤—É—î –º–æ–¥—É–ª—å **Bluetooth Low Energy** –¥–ª—è —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –Ω–∞–≤–∫–æ–ª–∏—à–Ω—ñ—Ö BLE-–ø—Ä–∏—Å—Ç—Ä–æ—ó–≤.
* **Bluetooth Proxy:** –ü–µ—Ä–µ–¥–∞—î –¥–∞–Ω—ñ, –∑—ñ–±—Ä–∞–Ω—ñ BLE Tracker, –¥–æ Home Assistant, —Ä–æ–∑—à–∏—Ä—é—é—á–∏ –ø–æ–∫—Ä–∏—Ç—Ç—è –º–µ—Ä–µ–∂—ñ —Ä–æ–∑—É–º–Ω–æ–≥–æ –±—É–¥–∏–Ω–∫—É.

# üè° –ö–µ—Ä—É–≤–∞–Ω–Ω—è –ø—Ä–∏—Å—Ç—Ä–æ—è–º–∏ Home Assistant (HA)

* **–î–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π –ó–≤'—è–∑–æ–∫:** ESPHome –º–æ–∂–µ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Å—Ç–∞—Ç—É—Å (`sensor.homeassistant`) —Ç–∞ –∫–µ—Ä—É–≤–∞—Ç–∏ —Å—É—Ç–Ω–æ—Å—Ç—è–º–∏ (`switch.homeassistant`) —É Home Assistant.
* **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è HA:** –î–ª—è —Ä–æ–±–æ—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó –∫–µ—Ä—É–≤–∞–Ω–Ω—è –≤ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó ESPHome —É Home Assistant –ø–æ—Ç—Ä—ñ–±–Ω–æ —É–≤—ñ–º–∫–Ω—É—Ç–∏ –æ–ø—Ü—ñ—é "Enable the API to allow the ESP device to register and control entities in Home Assistant."

https://youtu.be/4dKZSFFEjWA
---

## üõ†Ô∏è –¢–µ—Ö–Ω—ñ—á–Ω—ñ –î–µ—Ç–∞–ª—ñ

### –ê–ø–∞—Ä–∞—Ç–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è
| –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ | ESP32-S3 DevKitC-1 |
| :--- | :--- |
| **–î–∏—Å–ø–ª–µ–π** | **ST7789V** (280x240) |
| DC Pin | GPIO15 |
| CS Pin | GPIO7 |
| CLK Pin | GPIO18 |
| MOSI Pin | GPIO17 |
| **–ñ–∏–≤–ª–µ–Ω–Ω—è –¥–∏—Å–ø–ª–µ—è** | GPIO46 |
| **I2S –ê—É–¥—ñ–æ** | LRCLK: GPIO1, BCLK: GPIO42, DOUT: GPIO2 |
| **–ë–∞—Ç–∞—Ä–µ—è** | ADC GPIO3 (–∑ –º–Ω–æ–∂–Ω–∏–∫–æ–º 1.33) |

### –ö–Ω–æ–ø–∫–∏ (Binary Sensor)

| –ö–Ω–æ–ø–∫–∞ | GPIO | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è |
| :--- | :--- | :--- |
| **Up** | 38 | –ù–∞–≤—ñ–≥–∞—Ü—ñ—è –≤–≥–æ—Ä—É / –ó–º—ñ–Ω–∞ —Ñ–æ–∫—É—Å—É |
| **Down** | 41 | –ù–∞–≤—ñ–≥–∞—Ü—ñ—è –≤–Ω–∏–∑ / –ó–º—ñ–Ω–∞ —Ñ–æ–∫—É—Å—É |
| **Select** | 0 | **–î—ñ—è** (–ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è **`boiler_switch`** Home Assistant) |
| Left | 39 | |
| Right | 40 | |
| A | 5 | |
| B | 6 | |
| C | 10 | |
| D | 9 | |
| Start | 4 | |

### –ó–≤'—è–∑–æ–∫ –∑ Home Assistant

* **Switch:** `switch.boiler_switch` –∫–µ—Ä—É—î—Ç—å—Å—è –∫–Ω–æ–ø–∫–æ—é `Select` —ñ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –Ω–∞ LVGL.
* **BLE:** –§—É–Ω–∫—Ü—ñ—è `bluetooth_proxy` –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤ Home Assistant.

---

## üöÄ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

1.  –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å [ESPHome](https://esphome.io/guides/getting_started_cli.html).
2.  –°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó `lilka.yaml`.
3.  –ù–∞–ª–∞—à—Ç—É–π—Ç–µ **WiFi credentials** —É `secrets.yaml`:
    ```yaml
    wifi_ssid: "YourWiFiName"
    wifi_password: "YourWiFiPassword"
    ```
4.  –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –ø—Ä–æ—à–∏–≤–∫—É: `esphome run lilka.yaml`

---

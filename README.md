# Lilka-ESPHome

# üíª ESPHome LVGL –¥–ª—è Lilka

**ESPHome –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –¥–ª—è Lilka –Ω–∞ –±–∞–∑—ñ ESP32-S3 –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é –≥—Ä–∞—Ñ—ñ—á–Ω–æ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—É LVGL (LittlevGL).**

---

## üöÄ –ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

–¶—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –∑–∞–±–µ–∑–ø–µ—á—É—î –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª:

* **–ì—Ä–∞—Ñ—ñ—á–Ω–∏–π –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å (LVGL):**
    * ‚úÖ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –¥–∏—Å–ø–ª–µ—è ST7789V (280x240, SPI).
    * ‚úÖ –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è [LVGL](https://esphome.io/components/lvgl/) –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É.
    * ‚úÖ **Flex Layout** –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç—ñ–≤.
    * ‚úÖ –î–∏–Ω–∞–º—ñ—á–Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è **—Å—Ç–∞–Ω—É –±–æ–π–ª–µ—Ä–∞ (Home Assistant Switch)**.
    * ‚úÖ –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è **—Ä—ñ–≤–Ω—è –∑–∞—Ä—è–¥—É —Ç–∞ –Ω–∞–ø—Ä—É–≥–∏ –±–∞—Ç–∞—Ä–µ—ó** –∑ –∞–≤—Ç–æ–æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º.

* **–°–∏—Å—Ç–µ–º–Ω—ñ –§—É–Ω–∫—Ü—ñ—ó:**
    * ‚úÖ **Bluetooth Proxy:** –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ø–æ–∫—Ä–∏—Ç—Ç—è BLE –º–µ—Ä–µ–∂—ñ Home Assistant.
    * ‚úÖ **I2S Audio Speaker/Media Player:** –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞—É–¥—ñ–æ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –æ–≥–æ–ª–æ—à–µ–Ω—å).
    * ‚úÖ **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –ë–∞—Ç–∞—Ä–µ—ó:** –í–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è –Ω–∞–ø—Ä—É–≥–∏ (**ADC GPIO3**) —Ç–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Ä—ñ–≤–Ω—è —É –≤—ñ–¥—Å–æ—Ç–∫–∞—Ö.
    * ‚úÖ **–ö–µ—Ä—É–≤–∞–Ω–Ω—è –ö–Ω–æ–ø–∫–∞–º–∏:** –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –Ω–∞–≤—ñ–≥–∞—Ü—ñ–π–Ω–∏—Ö (Up/Down) —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏—Ö –∫–Ω–æ–ø–æ–∫, —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—è –ø–æ LVGL-–≤—ñ–¥–∂–µ—Ç–∞—Ö.

* **–ú–µ—Ä–µ–∂–∞ —Ç–∞ –°—É–ø—Ä–æ–≤—ñ–¥:**
    * ‚úÖ **Wi-Fi:** –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Ç–∞ **Fallback Hotspot**.
    * ‚úÖ **Web-—Å–µ—Ä–≤–µ—Ä** —Ç–∞ **Captive Portal**.
    * ‚úÖ **OTA** (Over-The-Air) –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–æ—à–∏–≤–∫–∏.
    * ‚úÖ **API** –¥–ª—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –∑ Home Assistant (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π).
    * ‚úÖ **ESP32-S3 –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è:** –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è ESP-IDF —Ç–∞ **Octal PSRAM (80MHz)**.

---

## üõ†Ô∏è –¢–µ—Ö–Ω—ñ—á–Ω—ñ –î–µ—Ç–∞–ª—ñ

### –ê–ø–∞—Ä–∞—Ç–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è
| –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ | ESP32-S3 DevKitC-1 |
| :--- | :--- |
| **–î–∏—Å–ø–ª–µ–π** | **ST7789V** (280x240) |
| DC Pin | GPIO15 |
| CS Pin | GPIO7 |
| CLK Pin | GPIO18 |
| MOSI Pin | GPIO17 |
| **–ñ–∏–≤–ª–µ–Ω–Ω—è –¥–∏—Å–ø–ª–µ—è** | GPIO46 |
| **I2S –ê—É–¥—ñ–æ** | LRCLK: GPIO1, BCLK: GPIO42, DOUT: GPIO2 |
| **–ë–∞—Ç–∞—Ä–µ—è** | ADC GPIO3 (–∑ –º–Ω–æ–∂–Ω–∏–∫–æ–º 1.33) |

### –ö–Ω–æ–ø–∫–∏ (Binary Sensor)

| –ö–Ω–æ–ø–∫–∞ | GPIO | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è |
| :--- | :--- | :--- |
| **Up** | 38 | –ù–∞–≤—ñ–≥–∞—Ü—ñ—è –≤–≥–æ—Ä—É / –ó–º—ñ–Ω–∞ —Ñ–æ–∫—É—Å—É |
| **Down** | 41 | –ù–∞–≤—ñ–≥–∞—Ü—ñ—è –≤–Ω–∏–∑ / –ó–º—ñ–Ω–∞ —Ñ–æ–∫—É—Å—É |
| **Select** | 0 | **–î—ñ—è** (–ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è **`boiler_switch`** Home Assistant) |
| Left | 39 | |
| Right | 40 | |
| A | 5 | |
| B | 6 | |
| C | 10 | |
| D | 9 | |
| Start | 4 | |

### –ó–≤'—è–∑–æ–∫ –∑ Home Assistant

* **Switch:** `switch.boiler_switch` –∫–µ—Ä—É—î—Ç—å—Å—è –∫–Ω–æ–ø–∫–æ—é `Select` —ñ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –Ω–∞ LVGL.
* **BLE:** –§—É–Ω–∫—Ü—ñ—è `bluetooth_proxy` –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤ Home Assistant.

---

## üöÄ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

1.  –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å [ESPHome](https://esphome.io/guides/getting_started_cli.html).
2.  –°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó `lilka.yaml`.
3.  –ù–∞–ª–∞—à—Ç—É–π—Ç–µ **WiFi credentials** —É `secrets.yaml`:
    ```yaml
    wifi_ssid: "YourWiFiName"
    wifi_password: "YourWiFiPassword"
    ```
4.  –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –ø—Ä–æ—à–∏–≤–∫—É: `esphome run lilka.yaml`

---
